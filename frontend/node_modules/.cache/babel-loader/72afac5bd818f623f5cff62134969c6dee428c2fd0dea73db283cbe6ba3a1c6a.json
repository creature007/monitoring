{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, createVNode as _createVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"reports\"\n};\nconst _hoisted_2 = {\n  class: \"report-controls\"\n};\nconst _hoisted_3 = {\n  class: \"period-selector\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"report-content\"\n};\nconst _hoisted_5 = {\n  class: \"report-summary\"\n};\nconst _hoisted_6 = {\n  class: \"card-title\"\n};\nconst _hoisted_7 = {\n  class: \"summary-stats\"\n};\nconst _hoisted_8 = {\n  class: \"summary-item\"\n};\nconst _hoisted_9 = {\n  class: \"total\"\n};\nconst _hoisted_10 = {\n  class: \"summary-item\"\n};\nconst _hoisted_11 = {\n  class: \"active\"\n};\nconst _hoisted_12 = {\n  class: \"summary-item\"\n};\nconst _hoisted_13 = {\n  class: \"inactive\"\n};\nconst _hoisted_14 = {\n  class: \"table-header\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Button = _resolveComponent(\"Button\");\n  const _component_Card = _resolveComponent(\"Card\");\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_Column = _resolveComponent(\"Column\");\n  const _component_DataTable = _resolveComponent(\"DataTable\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[7] || (_cache[7] = _createElementVNode(\"h1\", null, \"Hisobotlar\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_Button, {\n    class: _normalizeClass({\n      active: $setup.period === 'weekly'\n    }),\n    onClick: _cache[0] || (_cache[0] = $event => $setup.setPeriod('weekly')),\n    label: \"Haftalik\",\n    icon: \"pi pi-calendar\"\n  }, null, 8 /* PROPS */, [\"class\"]), _createVNode(_component_Button, {\n    class: _normalizeClass({\n      active: $setup.period === 'monthly'\n    }),\n    onClick: _cache[1] || (_cache[1] = $event => $setup.setPeriod('monthly')),\n    label: \"Oylik\",\n    icon: \"pi pi-calendar-times\"\n  }, null, 8 /* PROPS */, [\"class\"])])]), $setup.report ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createCommentVNode(\" Umumiy ma'lumotlar \"), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_Card, {\n    class: \"summary-card\"\n  }, {\n    title: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_cache[2] || (_cache[2] = _createElementVNode(\"i\", {\n      class: \"pi pi-calendar\"\n    }, null, -1 /* CACHED */)), _createTextVNode(\" \" + _toDisplayString($setup.report.period), 1 /* TEXT */)])]),\n    content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", null, \"Jami qurilmalar\", -1 /* CACHED */)), _createElementVNode(\"span\", _hoisted_9, _toDisplayString($setup.report.total_devices), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_10, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", null, \"Faol qurilmalar\", -1 /* CACHED */)), _createElementVNode(\"span\", _hoisted_11, _toDisplayString($setup.report.active_devices), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_12, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", null, \"Nofaol qurilmalar\", -1 /* CACHED */)), _createElementVNode(\"span\", _hoisted_13, _toDisplayString($setup.report.inactive_devices), 1 /* TEXT */)])])]),\n    _: 1 /* STABLE */\n  })]), _createCommentVNode(\" Qurilmalar ro'yxati \"), _createVNode(_component_Card, {\n    class: \"devices-table\"\n  }, {\n    title: _withCtx(() => [_createElementVNode(\"div\", _hoisted_14, [_cache[6] || (_cache[6] = _createElementVNode(\"div\", {\n      class: \"card-title\"\n    }, [_createElementVNode(\"i\", {\n      class: \"pi pi-list\"\n    }), _createTextVNode(\" Qurilmalar ro'yxati \")], -1 /* CACHED */)), _createVNode(_component_Button, {\n      icon: \"pi pi-download\",\n      label: \"Yuklash\",\n      onClick: $setup.downloadReport\n    }, null, 8 /* PROPS */, [\"onClick\"])])]),\n    content: _withCtx(() => [_createVNode(_component_DataTable, {\n      value: $setup.report.devices,\n      paginator: true,\n      rows: 10,\n      responsiveLayout: \"scroll\",\n      class: \"p-datatable-sm\",\n      sortField: \"lastupdate\",\n      sortOrder: -1\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Column, {\n        field: \"number\",\n        header: \"Qurilma raqami\",\n        sortable: \"\"\n      }, {\n        body: _withCtx(slotProps => [_createVNode(_component_router_link, {\n          to: '/device/' + slotProps.data.id,\n          class: \"device-link\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(slotProps.data.number), 1 /* TEXT */)]),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_Column, {\n        field: \"description\",\n        header: \"Tavsif\",\n        sortable: \"\"\n      }), _createVNode(_component_Column, {\n        field: \"status_period\",\n        header: \"Davr holati\",\n        sortable: \"\"\n      }, {\n        body: _withCtx(slotProps => [_createElementVNode(\"span\", {\n          class: _normalizeClass(['status-badge', slotProps.data.status_period])\n        }, _toDisplayString(slotProps.data.status_period === 'active' ? 'Faol' : 'Nofaol'), 3 /* TEXT, CLASS */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_Column, {\n        field: \"lastupdate\",\n        header: \"Oxirgi faollik\",\n        sortable: \"\"\n      }, {\n        body: _withCtx(slotProps => [_createTextVNode(_toDisplayString($setup.formatDate(slotProps.data.lastupdate)), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"value\"])]),\n    _: 1 /* STABLE */\n  })])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_Button","_normalizeClass","active","$setup","period","onClick","_cache","$event","setPeriod","label","icon","report","_hoisted_4","_createCommentVNode","_hoisted_5","_component_Card","title","_withCtx","_hoisted_6","_toDisplayString","content","_hoisted_7","_hoisted_8","_hoisted_9","total_devices","_hoisted_10","_hoisted_11","active_devices","_hoisted_12","_hoisted_13","inactive_devices","_hoisted_14","downloadReport","_component_DataTable","value","devices","paginator","rows","responsiveLayout","sortField","sortOrder","_component_Column","field","header","sortable","body","slotProps","_component_router_link","to","data","id","number","status_period","formatDate","lastupdate"],"sources":["C:\\Users\\user\\Desktop\\dastur\\hp\\monitoring\\frontend\\src\\views\\Reports.vue"],"sourcesContent":["<template>\r\n  <div class=\"reports\">\r\n    <h1>Hisobotlar</h1>\r\n\r\n    <div class=\"report-controls\">\r\n      <div class=\"period-selector\">\r\n        <Button \r\n          :class=\"{ active: period === 'weekly' }\" \r\n          @click=\"setPeriod('weekly')\"\r\n          label=\"Haftalik\"\r\n          icon=\"pi pi-calendar\"\r\n        />\r\n        <Button \r\n          :class=\"{ active: period === 'monthly' }\" \r\n          @click=\"setPeriod('monthly')\"\r\n          label=\"Oylik\"\r\n          icon=\"pi pi-calendar-times\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"report-content\" v-if=\"report\">\r\n      <!-- Umumiy ma'lumotlar -->\r\n      <div class=\"report-summary\">\r\n        <Card class=\"summary-card\">\r\n          <template #title>\r\n            <div class=\"card-title\">\r\n              <i class=\"pi pi-calendar\"></i>\r\n              {{ report.period }}\r\n            </div>\r\n          </template>\r\n          <template #content>\r\n            <div class=\"summary-stats\">\r\n              <div class=\"summary-item\">\r\n                <label>Jami qurilmalar</label>\r\n                <span class=\"total\">{{ report.total_devices }}</span>\r\n              </div>\r\n              <div class=\"summary-item\">\r\n                <label>Faol qurilmalar</label>\r\n                <span class=\"active\">{{ report.active_devices }}</span>\r\n              </div>\r\n              <div class=\"summary-item\">\r\n                <label>Nofaol qurilmalar</label>\r\n                <span class=\"inactive\">{{ report.inactive_devices }}</span>\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </Card>\r\n      </div>\r\n\r\n      <!-- Qurilmalar ro'yxati -->\r\n      <Card class=\"devices-table\">\r\n        <template #title>\r\n          <div class=\"table-header\">\r\n            <div class=\"card-title\">\r\n              <i class=\"pi pi-list\"></i>\r\n              Qurilmalar ro'yxati\r\n            </div>\r\n            <Button icon=\"pi pi-download\" label=\"Yuklash\" @click=\"downloadReport\" />\r\n          </div>\r\n        </template>\r\n        <template #content>\r\n          <DataTable \r\n            :value=\"report.devices\" \r\n            :paginator=\"true\" \r\n            :rows=\"10\"\r\n            responsiveLayout=\"scroll\"\r\n            class=\"p-datatable-sm\"\r\n            sortField=\"lastupdate\"\r\n            :sortOrder=\"-1\"\r\n          >\r\n            <Column field=\"number\" header=\"Qurilma raqami\" sortable>\r\n              <template #body=\"slotProps\">\r\n                <router-link :to=\"'/device/' + slotProps.data.id\" class=\"device-link\">\r\n                  {{ slotProps.data.number }}\r\n                </router-link>\r\n              </template>\r\n            </Column>\r\n            <Column field=\"description\" header=\"Tavsif\" sortable />\r\n            <Column field=\"status_period\" header=\"Davr holati\" sortable>\r\n              <template #body=\"slotProps\">\r\n                <span :class=\"['status-badge', slotProps.data.status_period]\">\r\n                  {{ slotProps.data.status_period === 'active' ? 'Faol' : 'Nofaol' }}\r\n                </span>\r\n              </template>\r\n            </Column>\r\n            <Column field=\"lastupdate\" header=\"Oxirgi faollik\" sortable>\r\n              <template #body=\"slotProps\">\r\n                {{ formatDate(slotProps.data.lastupdate) }}\r\n              </template>\r\n            </Column>\r\n          </DataTable>\r\n        </template>\r\n      </Card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue'\r\nimport axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'Reports',\r\n  setup() {\r\n    const period = ref('weekly')\r\n    const report = ref(null)\r\n\r\n    const fetchReport = async () => {\r\n      try {\r\n        const response = await axios.get('http://127.0.0.1:8007/api/report', {\r\n          params: { type: period.value }\r\n        })\r\n        report.value = response.data.report\r\n      } catch (error) {\r\n        console.error('Hisobot olishda xatolik:', error)\r\n      }\r\n    }\r\n\r\n    const setPeriod = async (newPeriod) => {\r\n      period.value = newPeriod\r\n      await fetchReport()\r\n    }\r\n\r\n    const formatDate = (timestamp) => {\r\n      if (!timestamp) return 'Mavjud emas'\r\n      return moment(timestamp).format('YYYY-MM-DD HH:mm:ss')\r\n    }\r\n\r\n    const downloadReport = () => {\r\n      if (!report.value) return\r\n\r\n      const data = report.value.devices.map(device => ({\r\n        'Qurilma raqami': device.number,\r\n        'Tavsif': device.description || '',\r\n        'Holat': device.status_period === 'active' ? 'Faol' : 'Nofaol',\r\n        'Oxirgi faollik': formatDate(device.lastupdate)\r\n      }))\r\n\r\n      const csvContent = \"data:text/csv;charset=utf-8,\" + \r\n        Object.keys(data[0]).join(\",\") + \"\\n\" +\r\n        data.map(row => Object.values(row).join(\",\")).join(\"\\n\")\r\n\r\n      const encodedUri = encodeURI(csvContent)\r\n      const link = document.createElement(\"a\")\r\n      link.setAttribute(\"href\", encodedUri)\r\n      link.setAttribute(\"download\", `hisobot_${period.value}_${moment().format('YYYY-MM-DD')}.csv`)\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n    }\r\n\r\n    onMounted(() => {\r\n      fetchReport()\r\n    })\r\n\r\n    return {\r\n      period,\r\n      report,\r\n      setPeriod,\r\n      formatDate,\r\n      downloadReport\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.reports {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 2rem;\r\n}\r\n\r\n.report-controls {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.period-selector {\r\n  display: flex;\r\n  gap: 1rem;\r\n}\r\n\r\n.period-selector .p-button {\r\n  transition: all 0.3s;\r\n}\r\n\r\n.period-selector .p-button.active {\r\n  background: #2196F3;\r\n  border-color: #2196F3;\r\n}\r\n\r\n.report-summary {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\r\n  gap: 1.5rem;\r\n}\r\n\r\n.card-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  font-size: 1.1rem;\r\n  color: #666;\r\n}\r\n\r\n.summary-stats {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 1rem;\r\n}\r\n\r\n.summary-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  text-align: center;\r\n}\r\n\r\n.summary-item label {\r\n  font-size: 0.875rem;\r\n  color: #666;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.summary-item span {\r\n  font-size: 1.5rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.summary-item span.total {\r\n  color: #2196F3;\r\n}\r\n\r\n.summary-item span.active {\r\n  color: #4caf50;\r\n}\r\n\r\n.summary-item span.inactive {\r\n  color: #f44336;\r\n}\r\n\r\n.table-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.device-link {\r\n  color: #2196F3;\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n}\r\n\r\n.device-link:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.status-badge {\r\n  padding: 0.25rem 0.75rem;\r\n  border-radius: 1rem;\r\n  font-size: 0.875rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.status-badge.active {\r\n  background: #e8f5e9;\r\n  color: #4caf50;\r\n}\r\n\r\n.status-badge.inactive {\r\n  background: #ffebee;\r\n  color: #f44336;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}